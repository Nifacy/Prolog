# Вариант P2V1

## Задача 1

Опишите предикат, преобразующий арифметическое выражение в список операций и операндов в постфиксной записи.
Пример: `expr2postfix(1+2*3,[1,2,3,*,+]).`

### Решение

```Prolog
expr2postfix(N, [N]) :- integer(N), !.
expr2postfix(E, R) :- E=..[Op, A, B], expr2postfix(A, X), expr2postfix(B, Y), append(X, Y, L), append(L, [Op], R).
```

## Задача 2

Пусть у нас есть двоичное дерево, в листьях которого находятся числа, а узлы не содержат полезной информации.

1. Предложите способ описания такого дерева на Прологе, приведите пример.
2. Опишите предикат генерации по дереву всех возможных арифметических выражений с такой же структурой (т.е. подставляя в узлы дерева все возможные арифметические операции)
3. Из всех сгенерированных выражений выражение с максимальным значением.

### Решение

```Prolog
%% 1. Представляем бинарное дерево, используя оператор '#'
:-op(700, xfy, #).

%% 2. Генерируем выражения через обход по дереву. Каждый узел (это оператор '#') меняем на математический оператор
gen(N,_,N) :- integer(N), !.
gen(E,O,R) :- E=..[_, A, B], gen(A,O,X), gen(B,O,Y), member(NOp, O),R=..[NOp, X, Y].
gen(E, N) :- gen(E, [+,-,/,*], R), N is R.

%% 3. Находим максимальное значение, используя св-во упорядоченности результирующего списка предиката setof
max_value(E, X) :- setof(N, gen(E, N), L), append(_, [X], L).
```

# Вариант P2V2

## Задание 1

Опишите предикат, преобразующий арифметическое выражение в список операций и операндов в префиксной записи.
Пример: `expr2prefix(1+2*3,[+,1,*,2,3]).`

### Решение

```Prolog
expr2prefix(N, [N]) :- integer(N), !.
expr2prefix(E, [Op|L]) :- E=..[Op, A, B], expr2prefix(A, X), expr2prefix(B, Y), append(X, Y, L).
```

## Задание 2

Номер автобусного билета содержит 6 цифр. Назовём билет обобщенно счастливым, если расстановкой между его первыми тремя цифрами и последними тремя цифрами всевозможных арифметических операций и скобок можно получить два выражения с одинаковыми значениями.

1. Описать предикат, проверяющий, является ли заданный билет обобщенно счастливым
2. Для билета, являющегося обобщенно счастливым, вывести все значения соответствующих выражений. 

### Решение

```Prolog
prefix2expr([N], N) :- integer(N), !.
prefix2expr([Op|T], E) :- append(X, Y, T), prefix2expr(X, A), prefix2expr(Y, B), E=..[Op, A, B].

expr_permutation([X, Y, Z], O, E) :-
    member(A, O), member(B, O),
    prefix2expr([A, X, B, Y, Z], E, []).

lucky([X, Y, Z, X2, Y2, Z2], E1, E2) :-
    expr_permutation([X, Y, Z], [+, -, /, *], E1),
    expr_permutation([X2, Y2, Z2], [+, -, /, *], E2),
    catch(
        (R is E1, R is E2),
        error(evaluation_error(zero_divisor), _),
        fail
    ), !.

lucky(T) :- lucky(T, _, _).
```

# Вариант P2V3

## Задача 1

Опишите предикат, совершающий замену переменных в некотором арифметическом выражении. Пример: `subst(1+x*(x+1),x,10,R) => R=1+10*(10+1)`

### Решение

```Prolog
substr(N, _, _, N) :- integer(N), !.
substr(X, X, N, N) :- !.
substr(E, X, N, R) :- E=..[Op, A, B], substr(A, X, N, R1), substr(B, X, N, R2), R=..[Op, R1, R2].
```

## Задача 2

При помощи Пролог-программы расшифруйте числовой ребус: `ОДИН + ОДИН = МНОГО`. В ребусе каждой букве соответствует какая-то цифра, разным буквам соответствуют разные цифры.

### Решение

*Пусто...*

# Вариант P2V4

## Задание 1

Опишите оператор `bis`, который позволяет вычислять на Прологе логические выражения, где `+` соответствует дизъюнкции, а `*` - конъюнкции. Пример:

```Prolog
?- X bis t * (t + f).
X = t.
```

### Решение

```Prolog
:- op(700, xfx, bis).

bis(t, E) :-
    bexpr(E, A), N is A, N = 1.
bis(f, E) :-
    bexpr(E, A), N is A, N = 0. 

bexpr(t, 1).
bexpr(f, 0).
bexpr(E, R) :- E=..[Op, A, B], bexpr(A, X), bexpr(B, Y), R=..[Op, X, Y].
```

## Задание 2

В IQ-тестах любят задачки на поиски недостающей фигуры, как приведено на рисунке.

1. Предложите способ представления фигур и их матрицы на Прологе
2. Решите задачу поиска недостающей фигуры для поля $3 \times 3$
3. Решите задачу для произвольного размера поля

### Решение

*Пусто...*
